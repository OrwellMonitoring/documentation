"use strict";(self.webpackChunkorwell_docs=self.webpackChunkorwell_docs||[]).push([[99],{3905:function(e,a,t){t.d(a,{Zo:function(){return u},kt:function(){return m}});var r=t(7294);function s(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function n(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){s(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,r,s=function(e,a){if(null==e)return{};var t,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var p=r.createContext({}),c=function(e){var a=r.useContext(p),t=a;return e&&(t="function"==typeof e?e(a):n(n({},a),e)),t},u=function(e){var a=c(e.components);return r.createElement(p.Provider,{value:a},e.children)},l={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},d=r.forwardRef((function(e,a){var t=e.components,s=e.mdxType,o=e.originalType,p=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(t),m=s,k=d["".concat(p,".").concat(m)]||d[m]||l[m]||o;return t?r.createElement(k,n(n({ref:a},u),{},{components:t})):r.createElement(k,n({ref:a},u))}));function m(e,a){var t=arguments,s=a&&a.mdxType;if("string"==typeof e||s){var o=t.length,n=new Array(o);n[0]=d;var i={};for(var p in a)hasOwnProperty.call(a,p)&&(i[p]=a[p]);i.originalType=e,i.mdxType="string"==typeof e?e:s,n[1]=i;for(var c=2;c<o;c++)n[c]=t[c];return r.createElement.apply(null,n)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},7210:function(e,a,t){t.r(a),t.d(a,{assets:function(){return u},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return l}});var r=t(7462),s=t(3366),o=(t(7294),t(3905)),n=["components"],i={sidebar_position:1,custom_edit_url:null},p="Suricata",c={unversionedId:"security/suricata",id:"security/suricata",title:"Suricata",description:"Suricata\xa0is a Network Security Monitoring (NSM) tool that uses sets of community created and user defined signatures (also referred to as rules) to examine and process network traffic. Suricata can generate log events, trigger alerts, and drop traffic when it detects suspicious packets or requests to any number of different services running on a server.",source:"@site/docs/security/suricata.md",sourceDirName:"security",slug:"/security/suricata",permalink:"/documentation/security/suricata",editUrl:null,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"System Agents",permalink:"/documentation/deployment/system-agents"},next:{title:"Infection Monkey",permalink:"/documentation/security/infection-monkey"}},u={},l=[{value:"Como instalar o Suricata",id:"como-instalar-o-suricata",level:2},{value:"Configurar o yaml do suricata",id:"configurar-o-yaml-do-suricata",level:2},{value:"Regras do Suricata",id:"regras-do-suricata",level:2},{value:"Testar se as regras est\xe3o a dar corretamente",id:"testar-se-as-regras-est\xe3o-a-dar-corretamente",level:2},{value:"Comandos a instalar",id:"comandos-a-instalar",level:2},{value:"Come\xe7ar a correr o suricata",id:"come\xe7ar-a-correr-o-suricata",level:2},{value:"Colocar o Suricata em IPS",id:"colocar-o-suricata-em-ips",level:2},{value:"Como saber em que modo esta o suricata",id:"como-saber-em-que-modo-esta-o-suricata",level:2},{value:"Logs do Suricata",id:"logs-do-suricata",level:2},{value:"Pesquisar por logs especificas",id:"pesquisar-por-logs-especificas",level:3},{value:"Logs em Json",id:"logs-em-json",level:3},{value:"Configurar a UFW para enviar trafego para o Suricata",id:"configurar-a-ufw-para-enviar-trafego-para-o-suricata",level:2},{value:"Como instalar o kibana e elasticSearch",id:"como-instalar-o-kibana-e-elasticsearch",level:2},{value:"Configurar o elasticSearch",id:"configurar-o-elasticsearch",level:2},{value:"Como correr o elasticSearch",id:"como-correr-o-elasticsearch",level:2},{value:"Como reduzir o espa\xe7o que o elasticSearch ocupa",id:"como-reduzir-o-espa\xe7o-que-o-elasticsearch-ocupa",level:2},{value:"Passwords geradas de forma autom\xe1tica",id:"passwords-geradas-de-forma-autom\xe1tica",level:2},{value:"Configurar o Kibana",id:"configurar-o-kibana",level:2},{value:"Configurar o filebeat",id:"configurar-o-filebeat",level:2},{value:"Colocar o suricata no filebeat",id:"colocar-o-suricata-no-filebeat",level:2},{value:"Dashboard para ver os dados",id:"dashboard-para-ver-os-dados",level:2}],d={toc:l};function m(e){var a=e.components,t=(0,s.Z)(e,n);return(0,o.kt)("wrapper",(0,r.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"suricata"},"Suricata"),(0,o.kt)("p",null,"Suricata\xa0is a Network Security Monitoring (NSM) tool that uses sets of community created and user defined signatures (also referred to as rules) to examine and process network traffic. Suricata can generate log events, trigger alerts, and drop traffic when it detects suspicious packets or requests to any number of different services running on a server.",(0,o.kt)("br",{parentName:"p"}),"\n","Este reposit\xf3rio tem como objetivo ter todos os fichieros necess\xe1rios para criar de formar simples e r\xe1pida um servi\xe7o suricata em modo IPS, Intrusion Prevention System , a correr num kibana, utilizando elastic Search.",(0,o.kt)("br",{parentName:"p"}),"\n","De salientar que todas as regras que est\xe3o a ser utilizadas no suricata s\xe3o simples e ba\u015bicas sendo da responsabilidade da testebed definir quais s\xe3o as regras que devem estar presentes.",(0,o.kt)("br",{parentName:"p"}),"\n","O suricata deve ter acesso a todos os pacotes da rede para eles o detetetar e dar as suas alarmisticas sendo que estes alarmes v\xe3o estar a ser enviadas para um slack, com todas as logs sendo que este slack deve tamb\xe9m ser alterado os tokens de acesso ao slack para funcionar.  "),(0,o.kt)("h2",{id:"como-instalar-o-suricata"},"Como instalar o Suricata"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo add-apt-repository ppa:oisf/suricata-stable"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo apt install suricata"),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl enable suricata.service"),(0,o.kt)("br",{parentName:"p"}),"\n","Output a receber:",(0,o.kt)("br",{parentName:"p"}),"\n",'"suricata.service is not a native service, redirecting to systemd-sysv-install.',(0,o.kt)("br",{parentName:"p"}),"\n",'Executing: /lib/systemd/systemd-sysv-install enable suricata"',(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl stop suricata.service"),"  -> Se tudo estiver certo, deve-se parar de correr porque ainda n\xe3o h\xe1 nada no suricata de regras  "),(0,o.kt)("h2",{id:"configurar-o-yaml-do-suricata"},"Configurar o yaml do suricata"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo nano /etc/suricata/suricata.yaml"),"  -> Colocar la o nosso ficheiro do suricata.yaml que esta neste reposit\xf3rio",(0,o.kt)("br",{parentName:"p"}),"\n","Caso se pretenda configurar uma nova interface basta, no ficheiro yaml nas linhas do ",(0,o.kt)("strong",{parentName:"p"},"af-packet"),": colocar a interface que se pretende e tamb\xe9m colocar um valor para o cluster id, salientar que este valor n\xe3o pode estar a ser utilizado nas outras interfaces.   "),(0,o.kt)("h2",{id:"regras-do-suricata"},"Regras do Suricata"),(0,o.kt)("p",null,"Para importar regras basicas no suricata, basta ir buscar regras por default com o comando: ",(0,o.kt)("strong",{parentName:"p"},"sudo suricata-update"),(0,o.kt)("br",{parentName:"p"}),"\n","Nota, as regras do surica-update v\xe3o para o ficheiro : ",(0,o.kt)("strong",{parentName:"p"},"/var/lib/suricata/rules/suricata.rules"),(0,o.kt)("br",{parentName:"p"}),"\n","Podem tamb\xe9m serem criadas regras, e essas podem ser colocadas no ",(0,o.kt)("strong",{parentName:"p"},"/var/lib/suricata/rules/local.rules")," que j\xe1 se encontra configurado no ficheiro yaml do suricata para aceitar as regras presentes neste ficheiro.  "),(0,o.kt)("h2",{id:"testar-se-as-regras-est\xe3o-a-dar-corretamente"},"Testar se as regras est\xe3o a dar corretamente"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo suricata -T -c /etc/suricata/suricata.yaml -v")),(0,o.kt)("h2",{id:"comandos-a-instalar"},"Comandos a instalar"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo apt update"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo apt install jq")),(0,o.kt)("h2",{id:"come\xe7ar-a-correr-o-suricata"},"Come\xe7ar a correr o suricata"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo systemctl start suricata.service"),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl status suricata.service"),"\nNotas:",(0,o.kt)("br",{parentName:"p"}),"\n","Esperar 1 a 2 minutos, suricata demora a correr",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo tail -f /var/log/suricata/suricata.log"),"  e receber o output : data-- horas - Info - All AFP capture threads are running.  "),(0,o.kt)("h2",{id:"colocar-o-suricata-em-ips"},"Colocar o Suricata em IPS"),(0,o.kt)("p",null,"Deve se ir a  /etc/default/suricata e alterar a linha:",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"LISTENMODE=af-packet")," para ",(0,o.kt)("strong",{parentName:"p"},"LISTENMODE=nfqueue")),(0,o.kt)("h2",{id:"como-saber-em-que-modo-esta-o-suricata"},"Como saber em que modo esta o suricata"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo systemctl status suricata.service"),(0,o.kt)("br",{parentName:"p"}),"\n","Nas linhas do fundo deve estar a indicar:Starting suricata in ",(0,o.kt)("strong",{parentName:"p"},"IPS")," (nfqueue) mode... done."),(0,o.kt)("h2",{id:"logs-do-suricata"},"Logs do Suricata"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"cat  /var/log/suricata/fast.log")," ou  ",(0,o.kt)("strong",{parentName:"p"},"cat  /var/log/suricata/eve.json"),(0,o.kt)("br",{parentName:"p"}),"\n","As logs aqui presentes est\xe3o a ser enviadas para um slack.   "),(0,o.kt)("h3",{id:"pesquisar-por-logs-especificas"},"Pesquisar por logs especificas"),(0,o.kt)("p",null,"Fazendo o sid da regra pode-se fazer grep de todas as ocorrencias da regra.",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"grep sid_number /var/log/suricata/fast.log")),(0,o.kt)("h3",{id:"logs-em-json"},"Logs em Json"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo apt install jq"),"\n",(0,o.kt)("strong",{parentName:"p"},"cat /var/log/suricata/eve.log"),"\n",(0,o.kt)("strong",{parentName:"p"},"jq 'select(.alert .signature_id==sid_number)' /var/log/suricata/eve.json")),(0,o.kt)("h2",{id:"configurar-a-ufw-para-enviar-trafego-para-o-suricata"},"Configurar a UFW para enviar trafego para o Suricata"),(0,o.kt)("p",null,"A definir pelo sistema no nosso sistema atual estamos a usar os ficheiros presentes no reposit\xf3rio sendo eles before.rules e before6.rules.",(0,o.kt)("br",{parentName:"p"}),"\n","Sitio onde colocar o before. rules, ",(0,o.kt)("strong",{parentName:"p"},"/etc/ufw/before.rules"),(0,o.kt)("br",{parentName:"p"}),"\n","Sitio onde colocar o before6. rules,",(0,o.kt)("strong",{parentName:"p"},"/etc/ufw/before6.rules"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo ufw enable"),(0,o.kt)("br",{parentName:"p"}),"\n","Neste ficheiro colocamos, as configura\xe7\xf5es que para n\xf3s serviam, para uma outra rede pode ser necess\xe1rio a altera\xe7\xe3o deste ficheiro.  "),(0,o.kt)("h2",{id:"como-instalar-o-kibana-e-elasticsearch"},"Como instalar o kibana e elasticSearch"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"curl -fsSL ",(0,o.kt)("a",{parentName:"strong",href:"https://artifacts.elastic.co/GPG-KEY-elasticsearch"},"https://artifacts.elastic.co/GPG-KEY-elasticsearch")," | sudo apt-key add -"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},'echo "deb ',(0,o.kt)("a",{parentName:"strong",href:"https://artifacts.elastic.co/packages/7.x/apt"},"https://artifacts.elastic.co/packages/7.x/apt"),' stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list'),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo apt update"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo apt install elasticsearch kibana")," "),(0,o.kt)("h2",{id:"configurar-o-elasticsearch"},"Configurar o elasticSearch"),(0,o.kt)("p",null,"Pode importar o ficheiro  elasticsearch.yml presente no nosso reposit\xf3rio e colocar em  ",(0,o.kt)("strong",{parentName:"p"},"/etc/elasticsearch/elasticsearch.yml"),' onde deve apenas alterar o campo onde diz "your_private_ip".',(0,o.kt)("br",{parentName:"p"}),"\n","Onde encontrar o your_private ip:",(0,o.kt)("br",{parentName:"p"}),"\n","By default Elasticsearch is only accessible on localhost. Set a different",(0,o.kt)("br",{parentName:"p"}),"\n","address here to expose this node on the network:",(0,o.kt)("br",{parentName:"p"}),"\n","network.host: 192.168.0.1",(0,o.kt)("br",{parentName:"p"}),"\n","network.bind_host: ",'["127.0.0.1", "your_private_ip"]',(0,o.kt)("br",{parentName:"p"}),"\n","By default Elasticsearch listens for HTTP traffic on the first free port it",(0,o.kt)("br",{parentName:"p"}),"\n","finds starting at 9200. Set a specific HTTP port here:  "),(0,o.kt)("h2",{id:"como-correr-o-elasticsearch"},"Como correr o elasticSearch"),(0,o.kt)("p",null,"Para as interfaces que pretende monitorizar colocar no comando abaixo\n",(0,o.kt)("strong",{parentName:"p"},"sudo ufw allow in on ethnumber"),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo ufw allow out on ethnumber")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo systemctl start elasticsearch.service"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl enable elasticsearch.service"),"  "),(0,o.kt)("h2",{id:"como-reduzir-o-espa\xe7o-que-o-elasticsearch-ocupa"},"Como reduzir o espa\xe7o que o elasticSearch ocupa"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo  vim /etc/elasticsearch/jvm.options"),"\nDentro do ficheiro colocar:  "),(0,o.kt)("h1",{id:"jvm-heap-size---see-etcelasticsearchjvmoptions"},"JVM Heap Size - see /etc/elasticsearch/jvm.options"),(0,o.kt)("p",null,"-Xms2g",(0,o.kt)("br",{parentName:"p"}),"\n","-Xmx2g",(0,o.kt)("br",{parentName:"p"}),"\n","E assim fica com 2g para o elasticSearch,se pretender 1Gb, basta meter",(0,o.kt)("br",{parentName:"p"}),"\n","-Xms1g\n-Xmx1g "),(0,o.kt)("h2",{id:"passwords-geradas-de-forma-autom\xe1tica"},"Passwords geradas de forma autom\xe1tica"),(0,o.kt)("p",null,"Correr os seguintes comandos: (NOTA ESTES COMANDOS S\xd3 PODEM SER CORRIDOS 1 VEZ LOGO DEVEM SER GUARDADOS NUM LOCAL SEGUROS AS PASSWORDS)",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"cd /usr/share/elasticsearch/bin"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo ./elasticsearch-setup-passwords auto"),"  "),(0,o.kt)("h2",{id:"configurar-o-kibana"},"Configurar o Kibana"),(0,o.kt)("p",null,"Correr os seguintes comandos: (NOTA ESTES COMANDOS S\xd3 PODEM SER CORRIDOS 1 VEZ LOGO DEVEM SER GUARDADOS NUM LOCAL SEGUROS AS PASSWORDS)",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"cd /usr/share/kibana/bin/"),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo ./kibana-encryption-keys generate -q")),(0,o.kt)("p",null,"Pode importar o nosso ficheiro de configura\xe7\xe3o do kibana.yml e altera-lo em ",(0,o.kt)("strong",{parentName:"p"},"sudo vim /etc/kibana/kibana.yml"),' , sendo apenas necess\xe1rio depois colocar passwords geradas substituir nos campos key pela respetiva key gerada anteriormente e trocar o "your ip" dentro do ficheiro yaml.  '),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"cd /usr/share/kibana/bin "),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo ./kibana-keystore add elasticsearch.username")," -> colocar: kibana_system",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo ./kibana-keystore add elasticsearch.password")," -> Password do kibana_system gerado em (sudo ./elasticsearch-setup-passwords auto)",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl start kibana.service"),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl enable kibana.service")),(0,o.kt)("h2",{id:"configurar-o-filebeat"},"Configurar o filebeat"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"curl -fsSL ",(0,o.kt)("a",{parentName:"strong",href:"https://artifacts.elastic.co/GPG-KEY-elasticsearch"},"https://artifacts.elastic.co/GPG-KEY-elasticsearch")," | sudo apt-key add -"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},'echo "deb ',(0,o.kt)("a",{parentName:"strong",href:"https://artifacts.elastic.co/packages/7.x/apt"},"https://artifacts.elastic.co/packages/7.x/apt"),' stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list'),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo apt update"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo apt install filebeat"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo nano /etc/filebeat/filebeat.yml")," e colocar :",(0,o.kt)("br",{parentName:"p"}),"\n","Starting with Beats version 6.0.0, the dashboards are loaded via the Kibana API.",(0,o.kt)("br",{parentName:"p"}),"\n","This requires a Kibana endpoint configuration.",(0,o.kt)("br",{parentName:"p"}),"\n","setup.kibana:",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},'host: "your_private_ip:5601"'),(0,o.kt)("br",{parentName:"p"}),"\n","output.elasticsearch:",(0,o.kt)("br",{parentName:"p"}),"\n","Array of hosts to connect to.",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"hosts: ",'["your_private_ip:9200"]'),"\nProtocol - either ",(0,o.kt)("inlineCode",{parentName:"p"},"http")," (default) or ",(0,o.kt)("inlineCode",{parentName:"p"},"https"),".",(0,o.kt)("br",{parentName:"p"}),"\n",'protocol: "https"',(0,o.kt)("br",{parentName:"p"}),"\n","Authentication credentials - either API key or username/password.",(0,o.kt)("br",{parentName:"p"}),"\n",'api_key: "id:api_key"',(0,o.kt)("br",{parentName:"p"}),"\n",'username: "elastic"',(0,o.kt)("br",{parentName:"p"}),"\n",'password: "pass do elastic gerado em  (sudo ./elasticsearch-setup-passwords auto)"  '),(0,o.kt)("h2",{id:"colocar-o-suricata-no-filebeat"},"Colocar o suricata no filebeat"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"sudo filebeat modules enable suricata"),"  , output esperado : (Enabled suricata)",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo filebeat setup")," : Output esperado :",(0,o.kt)("br",{parentName:"p"}),"\n","Overwriting ILM policy is disabled. Set ",(0,o.kt)("inlineCode",{parentName:"p"},"setup.ilm.overwrite: true")," for enabling.",(0,o.kt)("br",{parentName:"p"}),"\n","Index setup finished.",(0,o.kt)("br",{parentName:"p"}),"\n","Loading dashboards (Kibana must be running and reachable)",(0,o.kt)("br",{parentName:"p"}),"\n","Loaded dashboards",(0,o.kt)("br",{parentName:"p"}),"\n","Setting up ML using setup --machine-learning is going to be removed in 8.0.0. Please use the ML app instead.",(0,o.kt)("br",{parentName:"p"}),"\n","See more: ",(0,o.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/machine-learning/current/index.html"},"https://www.elastic.co/guide/en/machine-learning/current/index.html"),(0,o.kt)("br",{parentName:"p"}),"\n","It is not possible to load ML jobs into an Elasticsearch 8.0.0 or newer using the Beat.",(0,o.kt)("br",{parentName:"p"}),"\n","Loaded machine learning job configurations",(0,o.kt)("br",{parentName:"p"}),"\n","Loaded Ingest pipelines  "),(0,o.kt)("p",null,"Ap\xf3s isto executar",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl start filebeat.service"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"sudo systemctl enable filebeat.service"),"  "),(0,o.kt)("h2",{id:"dashboard-para-ver-os-dados"},"Dashboard para ver os dados"),(0,o.kt)("p",null,"http://your_ip:5601/\nColocar o user e a password do elastic que foi gerado anteriormente  "),(0,o.kt)("p",null,"type:dashboard suricata  Alerts",(0,o.kt)("br",{parentName:"p"}),"\n","type:dashboard suricata  Events"))}m.isMDXComponent=!0}}]);